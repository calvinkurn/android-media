apply plugin: 'com.android.library'
apply from: "$rootProject.projectDir/buildconfig/kotlin/module.gradle"
apply plugin: 'io.hansel.preprocessor.module'
apply from: "../../../compile-unit-test.gradle"
apply from: "../../../compile-instrument-test.gradle"

buildscript {
    repositories {
        maven {
            url "https://maven.google.com"
        }
        google()
        maven { url 'https://maven.fabric.io/public' }
        mavenCentral()
        jcenter()
        maven { url 'https://maven-hansel.tokopedia.com/maven' }
    }
    dependencies {
        classpath rootProject.ext.gradlePlugin.crashlytics
        classpath rootProject.ext.miscDependencies.hansel
    }
}

android {
    packagingOptions {
        exclude 'META-INF/**'
    }

    defaultConfig {
        multiDexEnabled(project.hasProperty('coverage') ? true : false)
        testInstrumentationRunner 'com.tokopedia.test.application.environment.InstrumentationTestRunner'
    }
    sourceSets.each {
        it.java.srcDirs += "src/$it.name/kotlin"
    }

    testOptions {
        unitTests.all {
            testLogging.events = ["passed", "skipped", "failed"]
        }
    }
}

buildscript {
    repositories {
        jcenter()
        mavenCentral()
        maven { url 'https://maven-hansel.tokopedia.com/maven' }
    }
    dependencies {
        classpath rootProject.ext.gradlePlugin.googleServices
        classpath rootProject.ext.miscDependencies.hansel
    }
}


dependencies {
    implementation project(rootProject.ext.libraries.core_legacy)
    implementation project(rootProject.ext.libraries.tkpdabstraction)
    implementation project(rootProject.ext.features.resourcesCommon)
    implementation project(rootProject.ext.features.mediaCommon)
    implementation project(rootProject.ext.libraries.tkpddesign)
    implementation project(rootProject.ext.libraries.tkpdabstraction)
    implementation project(rootProject.ext.libraries.baseList)
    implementation project(rootProject.ext.libraries.commonNetwork)
    implementation project(rootProject.ext.libraries.applink)
    implementation project(rootProject.ext.libraries.remoteConfig)
    implementation project(rootProject.ext.libraries.analytics)
    implementation project(rootProject.ext.libraries.utils)
    implementation project(rootProject.ext.features.sessioncommon)
    implementation project(rootProject.ext.features.commonWallet)
    implementation project(rootProject.ext.features.resourcesCommon)
    implementation project(rootProject.ext.features.affiliateCommon)
    implementation project(rootProject.ext.features.navigationCommon)
    implementation project(rootProject.ext.features.goldMerchantCommon)
    implementation project(rootProject.ext.features.topAdsManagementCommon)
    implementation project(rootProject.ext.features.userIdentificationCommon)
    implementation project(rootProject.ext.features.recommendationWidgetCommon)
    implementation project(rootProject.ext.features.productCard)
    implementation project(rootProject.ext.features.discoveryCommon)
    implementation project(rootProject.ext.features.topAdsSdk)
    implementation project(rootProject.ext.libraries.trackingOptimizer)
    implementation project(rootProject.ext.features.wishlistCommon)
    implementation project(rootProject.ext.libraries.track)
    implementation project(rootProject.ext.libraries.webview)
    implementation project(rootProject.ext.libraries.kotlinExtensions)
    implementation project(rootProject.ext.features.sellerMigrationCommon)
    implementation project(rootProject.ext.features.sellerMenuCommon)
    implementation project(rootProject.ext.features.homeAccountUser)
    implementation project(rootProject.ext.features.internalReview)
    implementation project(rootProject.ext.libraries.coreNetwork)
    implementation project(rootProject.ext.libraries.cmPushNotifications)
    implementation project(rootProject.ext.libraries.logger)
    implementation rootProject.ext.tkpdInternalLibDependencies.cachemanager

    implementation rootProject.ext.unifyDependencies.icon
    implementation rootProject.ext.unifyDependencies.principles
    implementation rootProject.ext.unifyDependencies.components
    implementation rootProject.ext.unifyDependencies.icons
    implementation rootProject.ext.unifyDependencies.dialog
    implementation rootProject.ext.unifyDependencies.iconNotification
    implementation rootProject.ext.unifyDependencies.global_error
    implementation rootProject.ext.tkpdInternalLibDependencies.usersession
    implementation rootProject.ext.tkpdInternalLibDependencies.usecase
    implementation project(rootProject.ext.libraries.graphql)
    implementation rootProject.ext.tkpdInternalLibDependencies.network
    implementation rootProject.ext.tkpdInternalLibDependencies.url
    implementation rootProject.ext.tkpdInternalLibDependencies.globalconfig
    implementation rootProject.ext.tkpdInternalLibDependencies.authentication

    implementation rootProject.ext.supportLibDependencies.constraintLayout
    implementation rootProject.ext.miscDependencies.roundCornerProgressBar
    implementation rootProject.ext.supportLibDependencies.preferenceV7
    implementation rootProject.ext.miscDependencies.dagger
    kapt rootProject.ext.miscDependencies.daggerCompiler

    kapt rootProject.ext.miscDependencies.lifeCycleRuntime
    implementation rootProject.ext.miscDependencies.lifecycleRuntimeKtx
    implementation rootProject.ext.miscDependencies.lifeCycleExtentions
    implementation rootProject.ext.playServicesDependencies.base
    implementation rootProject.ext.playServicesDependencies.auth
    implementation rootProject.ext.tkpdInternalLibDependencies.analyticConstants
    implementation rootProject.ext.miscDependencies.multiDex
    implementation(rootProject.ext.miscDependencies.facebook) {
        exclude group: 'com.android.support'
    }
    implementation rootProject.ext.networkDependencies.glide
    implementation rootProject.ext.firebase.crashlytics
    implementation(rootProject.ext.tkpdLibDependencies.showcase) {
        exclude group: "com.android.support"
    }
    implementation project(rootProject.ext.libraries.webview)
    implementation project(rootProject.ext.libraries.kotlinExtensions)

    implementation project(rootProject.ext.features.moengageWrapper)
    if (rootProject.ext.debugToolsEnabled) {
        implementation project(rootProject.ext.libraries.analyticsDebugger)
    } else {
        implementation project(rootProject.ext.libraries.analyticsDebuggerNoop)
    }

    androidTestImplementation rootProject.ext.testDependencies.androidRulesVersion
    androidTestImplementation rootProject.ext.playServicesDependencies.core
    androidTestImplementation rootProject.ext.firebase.core

    testImplementation rootProject.ext.testDependencies.junitJupiterApi
    testImplementation rootProject.ext.testDependencies.assertJ
    testImplementation rootProject.ext.supportLibDependencies.kotlinReflection
    testImplementation rootProject.ext.testDependencies.json

    androidTestImplementation rootProject.ext.testDependencies.androidxTest

    // UI Test
    androidTestImplementation rootProject.ext.testDependencies.androidTestRunner
    androidTestImplementation rootProject.ext.testDependencies.androidRulesVersion
    androidTestImplementation rootProject.ext.testDependencies.junit
    androidTestImplementation rootProject.ext.testDependencies.mockkAndroid
    androidTestImplementation rootProject.ext.testDependencies.espressoCore
    androidTestImplementation rootProject.ext.testDependencies.espressoContrib
    androidTestImplementation rootProject.ext.testDependencies.espressoIntents
    androidTestImplementation project(rootProject.ext.libraries.instrumentation_test)
    androidTestAnnotationProcessor rootProject.ext.miscDependencies.daggerCompiler
    androidTestImplementation rootProject.ext.testDependencies.archCoreTesting
    androidTestImplementation rootProject.ext.testDependencies.benchmark
    androidTestImplementation rootProject.ext.testDependencies.testCore
    androidTestImplementation project(rootProject.ext.libraries.analyticsDebugger)

    // Unit test
    testImplementation rootProject.ext.testDependencies.archCoreTesting
    testImplementation rootProject.ext.testDependencies.mockk
    testImplementation rootProject.ext.supportLibDependencies.kotlinReflection
    testImplementation rootProject.ext.testDependencies.json
    testImplementation rootProject.ext.miscDependencies.coroutineCore
    testImplementation rootProject.ext.miscDependencies.coroutineTest
    testImplementation project(rootProject.ext.libraries.unitTest)
}

project.ext {
    artifactId = 'account'
    groupId = 'com.tokopedia.home'
    versionName = "0.0.2"
    artifactName = "account-home-release"
}

apply from: '../../../publish_local.gradle'
apply from: '../../../jacoco_task.gradle'
apply from: '../../../sonar_config.gradle'