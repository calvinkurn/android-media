apply plugin: 'com.android.library'
apply from: "$rootProject.projectDir/buildconfig/kotlin/core-module.gradle"
apply plugin: 'io.hansel.preprocessor.module'
apply plugin: 'kotlin-kapt'
apply plugin: 'kotlin-parcelize'

kapt {
    correctErrorTypes true
    useBuildCache true
}

android {
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    kotlinOptions {
        jvmTarget = "1.8"
    }

    buildTypes {
        debug {
            ext.enableHansel = project.hasProperty('hanselEnableDebug')
            testCoverageEnabled (project.hasProperty('coverage'))
        }
        release {
            ext.enableHansel = !project.hasProperty('hanselDisableRelease')
            minifyEnabled false
            consumerProguardFiles 'proguard-rules.pro'
        }
    }

    buildFeatures {
        viewBinding true
    }
}

buildscript {
    repositories {
        google()
        mavenCentral()
        maven { url 'https://maven-hansel.tokopedia.com/maven' }
    }
    dependencies {
        classpath rootProject.ext.miscDependencies.hansel
    }
}

dependencies {
    implementation rootProject.ext.tkpdInternalLibDependencies.larixBroadcaster
    implementation projectOrAar(rootProject.ext.libraries.usersession)
    implementation rootProject.ext.tkpdInternalLibDependencies.globalconfig

    implementation rootProject.ext.supportLibDependencies.constraintLayout
    implementation rootProject.ext.supportLibDependencies.kotlinSupport
    implementation rootProject.ext.supportLibDependencies.design

    implementation projectOrAar(rootProject.ext.libraries.kotlinExtensions)
    implementation projectOrAar(rootProject.ext.libraries.tkpdabstraction)
    implementation projectOrAar(rootProject.ext.libraries.remoteConfig)
    implementation projectOrAar(rootProject.ext.libraries.applink)
    implementation projectOrAar(rootProject.ext.libraries.logger)
    implementation projectOrAar(rootProject.ext.libraries.utils)
    implementation projectOrAar(rootProject.ext.libraries.deviceInfo)

    implementation rootProject.ext.miscDependencies.viewModel

    implementation rootProject.ext.miscDependencies.coroutineCore
    implementation rootProject.ext.miscDependencies.coroutineAndroid

    compileOnly rootProject.ext.miscDependencies.javaxAnnotation
    implementation rootProject.ext.dbDependencies.dbRoomRuntime
    kapt rootProject.ext.dbDependencies.dbRoomCompiler

    implementation rootProject.ext.miscDependencies.dagger
    kapt rootProject.ext.miscDependencies.daggerCompiler
    implementation rootProject.ext.unifyDependencies.principles

    testImplementation rootProject.ext.testDependencies.mockk
    testImplementation rootProject.ext.testDependencies.kotlinTest
    testImplementation rootProject.ext.miscDependencies.coroutineTest
    testImplementation rootProject.ext.testDependencies.archCoreTesting
    testImplementation rootProject.ext.supportLibDependencies.kotlinReflection

    androidTestImplementation rootProject.ext.dbDependencies.dbRoomTesting
}

project.ext {
    artifactId = 'live-broadcaster'
    groupId = 'com.tokopedia.broadcaster'
    versionName = "0.0.1"
    artifactName = "live-broadcaster-release"
}

apply from: '../../../publish_local.gradle'
apply from: '../../../jacoco_task.gradle'
apply from: '../../../sonar_config.gradle'