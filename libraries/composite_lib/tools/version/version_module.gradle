import com.tokopedia.plugin.ScanSubProjectTaskB

// jadi cara `ini` store semua variable diantara task
task readGradlefile(type: ReadGradlefileTasks){
    subprojects = project.subprojects
    doLast{
        lastRelease = scanReleaseDate.listReleaseDate[scanReleaseDate.listReleaseDate.size()-1]
        listVersion = versionDependency.listVersion
        listTree = versionDependency.listTree
        topList()
        readVersionConfig()
        moduleVersionUpdate()
    }
}

// scan semua subproject dan simpan dalam list `listModule`
task scanSubproject(type: ScanSubprojectTasks){}

task scanSubprojectB(type: ScanSubProjectTaskB){}

// simpan lokasi release date `fileDir` & scan semua release date dan simpan di list `listReleaseDate`
task scanReleaseDate(type: ScanReleaseDateTasks,dependsOn: scanSubproject){
    fileDir = 'tools/version/release_date.txt'
    doLast{
        println "scan release date"
    }
}

task versionDependency(type: VersionTasks, dependsOn: scanReleaseDate) {
    // simpan list release date
    listReleaseDate = scanReleaseDate.listReleaseDate

    // setelah task dipanggil selesaikan dengan readGradle
    finalizedBy readGradlefile

    // simpan root Project {Project}
    rootProjectTask = rootProject
}